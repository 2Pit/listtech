# üì¶ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç: Indexer (`listtech-indexer`)

`Indexer` –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø—Ä–∏—ë–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º–∞–º–∏, –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–º–∏—Ç—ã –∏ –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏—è—Ö —Å—Ö–µ–º.

---

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- –ü—Ä–∏—ë–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–æ–¥–∏–Ω–æ—á–Ω—ã—Ö –∏ bulk)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º–æ–π (—Å–æ–∑–¥–∞–Ω–∏–µ, –º–∏–≥—Ä–∞—Ü–∏–∏, –∏—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π)
- –•—Ä–∞–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–π —Å—Ö–µ–º—ã –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–º–∏—Ç—ã:
  - –ø–æ —Ç–∞–π–º–µ—Ä—É (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç)
  - –ø—Ä–∏ –º–∞—Å—Å–æ–≤—ã—Ö –∑–∞–≥—Ä—É–∑–∫–∞—Ö (–ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)
- –ü–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ö–µ–º—ã
- –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –±–∏–∑–Ω–µ—Å –æ–±—è–∑–∞–Ω —É–∫–∞–∑—ã–≤–∞—Ç—å –≤–µ—Ä—Å–∏—é —Å—Ö–µ–º—ã, —Å –∫–æ—Ç–æ—Ä–æ–π –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ ‚Äî –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–∞–∫ –Ω–∞–±–æ—Ä `IndexableField`

---

## üìê –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã

- –°–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤–∞—è —Å—Ö–µ–º–∞ ‚Üí –Ω–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å (–æ—Ç–¥–µ–ª—å–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è)
- –î–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –ø–µ—Ä–µ—Å—ã–ª–∞—é—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–Ω–µ—à–Ω–∏–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º (–±–∏–∑–Ω–µ—Å-—Å–ª–æ–µ–º)
- Indexer –Ω–µ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è —Å–∞–º: –æ–Ω –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç –≤ —Ç—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∏—Å–ª–∞–Ω–Ω–æ–π `schema_version` (–∏–ª–∏ `index_version`)
- –ê–∫—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è –∏–Ω–¥–µ–∫—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è Searcher'–æ–º) —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ ‚Äî —á–µ—Ä–µ–∑ Admin

---

## üì¶ API (—á–µ—Ä–µ–∑ Protobuf –∏–ª–∏ HTTP/gRPC)

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º–æ–π

| –ú–µ—Ç–æ–¥   | –ü—É—Ç—å              | –û–ø–∏—Å–∞–Ω–∏–µ                           |
|---------|-------------------|------------------------------------|
| `POST`  | `/schema`         | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Å—Ö–µ–º—É                |
| `PUT`   | `/schema`         | –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é (`schema_diff`) |
| `GET`   | `/schema`         | –ü–æ–ª—É—á–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é —Å—Ö–µ–º—É            |
| `GET`   | `/schema/history` | –ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –≤–µ—Ä—Å–∏–π —Å—Ö–µ–º       |

### –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

| –ú–µ—Ç–æ–¥   | –ü—É—Ç—å          | –û–ø–∏—Å–∞–Ω–∏–µ                              |
|---------|---------------|-----------------------------------------|
| `POST`  | `/doc`        | –î–æ–±–∞–≤–∏—Ç—å –æ–¥–∏–Ω –¥–æ–∫—É–º–µ–Ω—Ç (—Å —É–∫–∞–∑–∞–Ω–∏–µ–º –≤–µ—Ä—Å–∏–∏) |
| `POST`  | `/bulk`       | –î–æ–±–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤           |
| `DELETE`| `/doc/{id}`   | –£–¥–∞–ª–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç                        |

---

## üìÑ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞

```proto
message IndexableField {
  string name = 1;
  oneof value {
    string string_value = 2;
    int64 int_value = 3;
    double double_value = 4;
    bool bool_value = 5;
  }
  repeated string facets = 6;
  bool stored = 7;
  bool indexed = 8;
  bool fast = 9;
  bool is_facet = 10;
}

message Document {
  string schema_version = 1;
  repeated IndexableField fields = 2;
}
```

‚ùó –ü–æ–ª–µ schema_version (–∏–ª–∏ index_version) –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: Indexer –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≤ –Ω—É–∂–Ω—ã–π –∏–Ω–¥–µ–∫—Å.

## üõ† –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

- –î–æ–∫—É–º–µ–Ω—Ç –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –±–∞–∑–æ–≤–æ–º —É—Ä–æ–≤–Ω–µ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞, —Ç–∏–ø—ã).
- –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:
  - –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é `tracing` –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON;
  - –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—é—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–æ—Ç–æ–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤;
  - –≤ –±—É–¥—É—â–µ–º –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –æ—á–µ—Ä–µ–¥—å (DLQ) –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.
- Indexer –Ω–µ –ø–∞–¥–∞–µ—Ç –∏–∑-–∑–∞ –æ–¥–Ω–æ–≥–æ –æ—à–∏–±–æ—á–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞.

---

## üîç –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ç—Ä–µ–π—Å–∏–Ω–≥

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `tracing`.
- –õ–æ–≥–∏ –ø–∏—à—É—Ç—Å—è –≤ stdout –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON.
- –õ–æ–≥–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `Promtail` –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ `Loki`.
- –¢—Ä–µ–π—Å—ã (`span`) –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ `Jaeger` —á–µ—Ä–µ–∑ `OpenTelemetry`.
- –í—Å–µ —Å–æ–±—ã—Ç–∏—è —Å–Ω–∞–±–∂–µ–Ω—ã —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏: `index`, `schema_version`, `doc_id`, `count`, –∏ —Ç.–ø.

---

## üß™ –ü–æ–≤–µ–¥–µ–Ω–∏–µ –Ω–∞ —ç—Ç–∞–ø–µ MVP

- –ê–∫—Ç–∏–≤–Ω–∞—è —Å—Ö–µ–º–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ PostgreSQL.
- –ö–æ–º–º–∏—Ç—ã –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, —Ä—É—á–Ω–æ–π `commit` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.
- –ü–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –ø—É—Ç—ë–º –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤—Å–µ—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.
- Indexer –Ω–µ –∑–Ω–∞–µ—Ç —Å–µ–º–∞–Ω—Ç–∏–∫–∏ –ø–æ–ª–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞ ‚Äî –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–∞–±–æ—Ä–æ–º `IndexableField`.
